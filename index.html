<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>FiÈ™e Arboret din Excel</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f8f5; }
    h2 { color: #2e8b57; }
    input, button { padding: 10px; margin: 10px 0; width: 100%; max-width: 400px; }
    button { background: #2e8b57; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #246b45; }
    #status { margin-top: 10px; color: #444; }
  </style>
</head>
<body>

  <h2>ğŸ“¤ ÃncarcÄƒ fiÈ™ier Excel</h2>
  <input type="file" id="excelInput" accept=".xlsx,.xls">
  <div id="status">Nicio Ã®ncÄƒrcare</div>

  <h2>ğŸ” Introdu cod UA</h2>
  <input type="text" id="uaInput" placeholder="Ex: 123A">
  <button onclick="genereazaFisa()">ğŸ“„ GenereazÄƒ fiÈ™Äƒ PDF</button>

  <script>
    let dateExcel = [];

    document.getElementById("excelInput").addEventListener("change", function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(evt) {
        const data = new Uint8Array(evt.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        dateExcel = XLSX.utils.sheet_to_json(sheet);
        document.getElementById("status").textContent = `âœ… FiÈ™ier Ã®ncÄƒrcat: ${file.name}`;
      };
      reader.readAsArrayBuffer(file);
    });

    async function genereazaFisa() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const codUA = document.getElementById("uaInput").value.trim();

      if (!codUA) {
        alert("âš ï¸ Introdu un cod UA!");
        return;
      }

      const rand = dateExcel.find(r => r.UA?.toString().trim() === codUA);
      if (!rand) {
        alert(`âŒ Cod UA "${codUA}" nu a fost gÄƒsit Ã®n Excel.`);
        return;
      }

      const fisa = `
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§¾ FiÈ™Äƒ UA: ${rand.UA}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ¢ ADM: ${rand.ADM || "-"}
ğŸŒ² Specie: ${rand.Specie || "-"}
ğŸ“… VÃ¢rstÄƒ: ${rand.VÃ¢rstÄƒ || "-"} ani
ğŸ“ Diametru: ${rand.Diametru || "-"} cm
ğŸ“ ÃnÄƒlÈ›ime: ${rand.ÃnÄƒlÈ›ime || "-"} m
ğŸŒ± ProvenienÈ›Äƒ: ${rand.ProvenienÈ›Äƒ || "-"}
ğŸ’š Vitalitate: ${rand.Vitalitate || "-"}
ğŸ¯ Èšel gospodÄƒrire: ${rand["Èšel gospodÄƒrire"] || "-"}
ğŸŒ Drum: ${rand.Drum || "-"}
âš ï¸ CondiÈ›ii: ${rand.CondiÈ›ii || "-"}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
`;

      doc.text(fisa.trim(), 10, 10);
      doc.save(`Fisa_${codUA}.pdf`);
    }
  </script>

</body>
</html>